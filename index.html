<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code Nation Multiplayer Drag & Drop</title>
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #f8f9fa;
        font-family: sans-serif;
      }
      #gameArea {
        width: 400px;
        height: 400px;
        background: white;
        border: 2px solid #ccc;
        position: relative;
        border-radius: 12px;
      }
      #box {
        width: 60px;
        height: 60px;
        background: #007bff;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        border-radius: 8px;
        cursor: grab;
      }
      #box:active {
        cursor: grabbing;
        background: #0056b3;
      }
    </style>

    <!-- Firebase App (required) -->
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js"></script>
    <!-- Firebase Realtime Database -->
    <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js"></script>

    <script>
      // Your Firebase config
      const firebaseConfig = {
        apiKey: "AIzaSyAhoX1ucK-e-63dw2196v0CZbCVkQhRowM",
        authDomain: "multiplayer-9b383.firebaseapp.com",
        databaseURL: "https://multiplayer-9b383-default-rtdb.firebaseio.com",
        projectId: "multiplayer-9b383",
        storageBucket: "multiplayer-9b383.appspot.com",
        messagingSenderId: "464835475049",
        appId: "1:464835475049:web:c0795457efec49a92854f8"
      };

      // Initialize Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const db = firebase.database();
    </script>
  </head>

  <body>
    <div id="gameArea">
      <div id="box"></div>
    </div>

    <script>
      const box = document.getElementById("box");
      const gameArea = document.getElementById("gameArea");
      const boxRef = db.ref("dragBox"); // Firebase path for the box

      let dragging = false;
      let offsetX, offsetY;

      // Move the box locally
      function moveBox(x, y) {
        box.style.left = x + "px";
        box.style.top = y + "px";
      }

      // Listen for updates from Firebase
      boxRef.on("value", (snapshot) => {
        const pos = snapshot.val();
        if (pos) moveBox(pos.x, pos.y);
      });

      // Mouse events
      box.addEventListener("mousedown", (e) => {
        dragging = true;
        const rect = box.getBoundingClientRect();
        offsetX = e.clientX - rect.left;
        offsetY = e.clientY - rect.top;
      });

      document.addEventListener("mousemove", (e) => {
        if (!dragging) return;
        const areaRect = gameArea.getBoundingClientRect();
        const x = e.clientX - areaRect.left - offsetX;
        const y = e.clientY - areaRect.top - offsetY;
        moveBox(x, y);
        boxRef.set({ x, y }); // update Firebase
      });

      document.addEventListener("mouseup", () => {
        dragging = false;
      });
    </script>
  </body>
</html>
