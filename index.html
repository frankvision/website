<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multiplayer Drag & Drop</title>

  <!-- Drag-and-drop CSS -->
  <style>
    /* Container */
    #gameArea {
      width: 400px;
      height: 400px;
      background: white;
      border: 2px solid #ccc;
      position: relative;
      border-radius: 12px;
      margin: 50px auto;
    }

    /* Drag box */
    #box {
      width: 60px;
      height: 60px;
      background: #007bff;
      position: absolute;
      top: 170px;
      left: 170px;
      border-radius: 8px;
      cursor: grab;
    }

    #box:active {
      cursor: grabbing;
      background: #0056b3;
    }
  </style>

  <!-- Firebase CDN scripts -->
  <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-database.js"></script>
</head>
<body>
  <div id="gameArea">
    <div id="box"></div>
  </div>

  <script>
    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAhoX1ucK-e-63dw2196v0CZbCVkQhRowM",
      authDomain: "multiplayer-9b383.firebaseapp.com",
      databaseURL: "https://multiplayer-9b383-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "multiplayer-9b383",
      storageBucket: "multiplayer-9b383.appspot.com",
      messagingSenderId: "464835475049",
      appId: "1:464835475049:web:c0795457efec49a92854f8"
    };

    // Initialize Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Drag-and-drop logic
    const box = document.getElementById("box");
    const gameArea = document.getElementById("gameArea");
    const boxRef = db.ref("dragBox");

    let dragging = false;
    let offsetX, offsetY;

    // Initialize box in Firebase if not present
    boxRef.once("value", snapshot => {
      if (!snapshot.exists()) {
        boxRef.set({ x: 170, y: 170 });
      }
    });

    // Listen to Firebase for updates
    boxRef.on("value", snapshot => {
      const pos = snapshot.val();
      if (pos) {
        box.style.left = pos.x + "px";
        box.style.top = pos.y + "px";
      }
    });

    // Mouse events
    box.addEventListener("mousedown", e => {
      dragging = true;
      const rect = box.getBoundingClientRect();
      offsetX = e.clientX - rect.left;
      offsetY = e.clientY - rect.top;
    });

    document.addEventListener("mousemove", e => {
      if (!dragging) return;
      const areaRect = gameArea.getBoundingClientRect();
      let x = e.clientX - areaRect.left - offsetX;
      let y = e.clientY - areaRect.top - offsetY;

      // Keep inside container
      x = Math.max(0, Math.min(areaRect.width - box.offsetWidth, x));
      y = Math.max(0, Math.min(areaRect.height - box.offsetHeight, y));

      // Move box locally
      box.style.left = x + "px";
      box.style.top = y + "px";

      // Update Firebase
      boxRef.set({ x, y });
    });

    document.addEventListener("mouseup", () => {
      dragging = false;
    });
  </script>
</body>
</html>
